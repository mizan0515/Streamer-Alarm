# 스트리머 알림 앱

한국 VTuber 스트리머들(아리사, 카린, 엘리, 에리스, 소풍왔니, 아라하시 타비)의 방송 시작, 카페 새 글, X(트위터) 새 글을 실시간으로 알려주는 Windows 데스크톱 애플리케이션입니다.

## 주요 기능

- **치지직 방송 알림**: API를 통해 실시간 방송 상태 확인
- **네이버 카페 새 글 알림**: 헤드리스 브라우저로 새 게시물 모니터링
- **X(트위터) 새 글 알림**: RSS 피드를 통한 새 트윗 확인
- **시스템 트레이 상주**: 백그라운드에서 조용히 실행
- **웹 기반 UI**: Streamlit을 사용한 직관적인 웹 인터페이스
- **자동 캐시 정리**: 1시간마다 자동으로 브라우저 캐시 및 임시 파일 정리
- **윈도우 시작시 자동 실행**: 부팅 후 자동으로 모니터링 시작
- **알림 기록**: 모든 알림 내역을 기록하고 관리

## 기술 스택

- **Streamlit**: 웹 기반 UI 프레임워크
- **Playwright**: 헤드리스 브라우저 자동화
- **pystray**: 시스템 트레이 메뉴
- **httpx**: 비동기 HTTP 클라이언트
- **win11toast**: 윈도우 네이티브 알림

## 설치 및 실행

### 1. 가상환경 설정 (권장)
```bash
python -m venv venv
venv\Scripts\activate
```

### 2. 필요 패키지 설치
```bash
pip install -r requirements.txt
playwright install
```

### 3. 애플리케이션 실행
```bash
python main.py
```

또는 배치 파일 사용:
```bash
run.bat
```

## 초기 설정

### 네이버 로그인
1. 앱 시작 후 웹 인터페이스(http://localhost:8501)가 자동으로 열립니다
2. "네이버 로그인" 버튼을 클릭하면 브라우저 창이 열립니다
3. 네이버 계정으로 로그인하세요
4. "자동 로그인" 체크박스가 자동으로 선택됩니다
5. 로그인 완료 후 브라우저는 헤드리스 모드로 전환됩니다

### 스트리머 관리
- 기본적으로 6명의 스트리머가 등록되어 있습니다 (아리사, 카린, 엘리, 에리스, 소풍왔니, 아라하시 타비)
- 웹 UI를 통해 새 스트리머를 추가하거나 기존 스트리머를 편집할 수 있습니다
- 각 스트리머별로 모니터링할 플랫폼을 선택할 수 있습니다:
  - 치지직 채널 ID
  - X(트위터) 사용자명
  - 네이버 카페 사용자 ID

## 사용법

### 시스템 트레이
- 앱은 시스템 트레이에서 실행됩니다
- 트레이 아이콘을 우클릭하여 메뉴에 접근할 수 있습니다:
  - 웹 인터페이스 열기
  - 상태 보기
  - 네이버 로그인
  - 종료

### 웹 인터페이스
웹 인터페이스는 3개의 탭으로 구성됩니다:

1. **스트리머 관리**: 등록된 스트리머 목록, 라이브 상태, 프로필 이미지
2. **알림 기록**: 모든 알림 내역 확인 및 관리
3. **설정**: 앱 설정, 네이버 로그인 관리, 알림 테스트

### 알림
- 새로운 활동이 감지되면 윈도우 알림이 표시됩니다
- 알림을 클릭하면 해당 콘텐츠로 이동합니다
- 모든 알림은 기록되어 나중에 확인할 수 있습니다
- 프로필 이미지가 알림에 포함됩니다

## 설정 옵션

- **체크 간격**: 모니터링 주기 설정 (기본: 30초)
- **캐시 정리 간격**: 자동 캐시 정리 주기 설정 (기본: 3600초/1시간)
- **윈도우 시작시 자동 실행**: 부팅 후 자동 시작
- **알림 표시**: 알림 활성화/비활성화
- **테마**: 다크/라이트 모드 선택

## 파일 구조

```
data/
├── streamers.json         # 스트리머 정보
├── notifications.json     # 알림 기록
├── settings.json          # 앱 설정
├── browser_session.json   # 브라우저 세션 데이터
├── live_status.json       # 실시간 라이브 상태
└── browser_data/          # 브라우저 캐시 및 세션 데이터

logs/
└── streamer_alarm_YYYYMMDD.log # 일별 로그 파일 (10MB 로테이션)

src/
├── config.py              # 설정 관리
├── monitors/              # 플랫폼별 모니터링 모듈
├── browser/               # 브라우저 자동화
├── ui/                    # 웹 UI 컴포넌트
└── utils/                 # 유틸리티 모듈
    ├── cache_cleaner.py   # 자동 캐시 정리
    ├── notification.py    # 윈도우 알림
    └── logger.py          # 로깅 시스템
```

## 자동 캐시 정리

애플리케이션은 성능 최적화를 위해 자동 캐시 정리 시스템을 포함합니다:

- **주기적 정리**: 1시간마다 자동으로 브라우저 캐시 정리
- **안전한 정리**: 중요한 세션 데이터는 보존하면서 캐시만 삭제
- **디스크 공간 절약**: 정리 없이 300MB+ 증가할 수 있는 캐시 크기 관리
- **설정 가능**: cache_cleanup_interval 설정으로 간격 조정 가능

## 문제 해결

### 네이버 로그인 실패
- 브라우저 데이터 초기화: `data/browser_data` 폴더 삭제
- 세션 파일 삭제: `data/browser_session.json` 삭제
- 앱 재시작 후 다시 로그인

### RSS 피드 오류
- 여러 Nitter 인스턴스를 백업으로 사용합니다
- 네트워크 연결 상태를 확인하세요

### 알림이 표시되지 않음
- 윈도우 알림 설정에서 앱 권한 확인
- 설정 탭에서 "알림 표시" 옵션 확인
- 설정 탭의 "알림 테스트" 버튼으로 테스트

### 성능 문제
- 자동 캐시 정리가 1시간마다 실행됩니다
- 로그 파일은 10MB마다 자동 로테이션됩니다
- 7일 이상 된 로그는 자동 삭제됩니다

### 웹 인터페이스 접속 불가
- 기본 포트: http://localhost:8501
- 방화벽 설정 확인
- 포트 충돌 시 다른 포트 사용

## 기능 특징

### 듀얼 브라우저 시스템
- 모니터링용 헤드리스 브라우저와 사용자 로그인용 브라우저 분리
- 안정적인 세션 관리 및 충돌 방지

### 실시간 UI 업데이트
- 라이브 상태 파일을 통한 실시간 스트리머 상태 표시
- 2초마다 UI 신호 처리로 빠른 응답성

### 최적화된 HTTP 통신
- 연결 풀링으로 효율적인 네트워크 사용
- 플랫폼별 최적화된 타임아웃 설정

## 라이선스

이 프로젝트는 개인 사용 목적으로 제작되었습니다.