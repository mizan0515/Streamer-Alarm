# 스트리머 알림 앱

한국 VTuber 스트리머들(아리사, 카린, 엘리, 에리스, 소풍왔니, 아라하시 타비)의 방송 시작, 카페 새 글, X(트위터) 새 글을 실시간으로 알려주는 Windows 데스크톱 애플리케이션입니다.

## 주요 기능

- **치지직 방송 알림**: API를 통해 실시간 방송 상태 확인
- **네이버 카페 새 글 알림**: 헤드리스 브라우저로 새 게시물 모니터링
- **X(트위터) 새 글 알림**: RSS 피드를 통한 새 트윗 확인
- **시스템 트레이 상주**: 백그라운드에서 조용히 실행
- **웹 기반 UI**: Streamlit을 사용한 직관적인 웹 인터페이스
- **자동 캐시 정리**: 1시간마다 자동으로 브라우저 캐시 및 임시 파일 정리
- **윈도우 시작시 자동 실행**: 부팅 후 자동으로 모니터링 시작
- **알림 기록**: 모든 알림 내역을 기록하고 관리

## 기술 스택

- **Streamlit**: 웹 기반 UI 프레임워크
- **Playwright**: 헤드리스 브라우저 자동화
- **pystray**: 시스템 트레이 메뉴
- **httpx**: 비동기 HTTP 클라이언트
- **win11toast**: 윈도우 네이티브 알림

## 설치 및 실행

### 1. 가상환경 설정 (권장)
```bash
python -m venv venv
venv\Scripts\activate
```

### 2. 필요 패키지 설치
```bash
pip install -r requirements.txt
playwright install
```

### 3. 애플리케이션 실행
```bash
python main.py
```

또는 배치 파일 사용:
```bash
run.bat
```

## 초기 설정

### 네이버 로그인
1. 앱 시작 후 웹 인터페이스(http://localhost:8501)가 자동으로 열립니다
2. "네이버 로그인" 버튼을 클릭하면 브라우저 창이 열립니다
3. 네이버 계정으로 로그인하세요
4. "자동 로그인" 체크박스가 자동으로 선택됩니다
5. 로그인 완료 후 브라우저는 헤드리스 모드로 전환됩니다

### 스트리머 관리
- 기본적으로 6명의 스트리머가 등록되어 있습니다 (아리사, 카린, 엘리, 에리스, 소풍왔니, 아라하시 타비)
- 웹 UI를 통해 새 스트리머를 추가하거나 기존 스트리머를 편집할 수 있습니다
- 각 스트리머별로 모니터링할 플랫폼을 선택할 수 있습니다:
  - 치지직 채널 ID
  - X(트위터) 사용자명
  - 네이버 카페 사용자 ID

## 사용법

### 시스템 트레이
- 앱은 시스템 트레이에서 실행됩니다
- 트레이 아이콘을 우클릭하여 메뉴에 접근할 수 있습니다:
  - 웹 인터페이스 열기
  - 상태 보기
  - 네이버 로그인
  - 종료

### 웹 인터페이스
웹 인터페이스는 3개의 탭으로 구성됩니다:

1. **스트리머 관리**: 등록된 스트리머 목록, 라이브 상태, 프로필 이미지
2. **알림 기록**: 모든 알림 내역 확인 및 관리
3. **설정**: 앱 설정, 네이버 로그인 관리, 알림 테스트

### 알림
- 새로운 활동이 감지되면 윈도우 알림이 표시됩니다
- 알림을 클릭하면 해당 콘텐츠로 이동합니다
- 모든 알림은 기록되어 나중에 확인할 수 있습니다
- 프로필 이미지가 알림에 포함됩니다

## 🔔 알림 시스템

### 📋 알림 종류

#### 🎬 방송 알림
- **트리거**: 스트리머가 치지직에서 방송 시작
- **내용**: 방송 제목, 스트리머 프로필 이미지
- **클릭**: 치지직 방송 페이지로 이동
- **제한**: 없음 (실시간 즉시 알림)

#### 📝 카페 알림  
- **트리거**: 네이버 카페에 새 게시물 작성
- **내용**: 게시물 제목, 스트리머 프로필 이미지
- **클릭**: 네이버 카페 게시물로 이동
- **제한**: 앱 시작시 최대 10개

#### 🐦 트위터 알림
- **트리거**: X(트위터)에 새 트윗 작성  
- **내용**: 트윗 내용 (100자 제한), 프로필 이미지
- **클릭**: X(트위터) 트윗으로 이동
- **제한**: 앱 시작시 최대 5개

### ⚡ 알림 동작 방식

#### 🚀 실시간 모니터링
```
스트리머 활동 감지 → 즉시 알림 → 기록 저장
```
- **방송**: 상태 변화 즉시 알림
- **카페/트위터**: 30초마다 체크, 새 항목 발견시 즉시 알림
- **연속 알림**: 3개 이상시 1초 간격으로 순차 발송

#### 🔄 앱 재시작시
```
저장된 알림 기록 확인 → 새 항목만 선별 → 제한된 알림 발송
```
- **중복 방지**: 이미 알림 보낸 항목은 재알림 안함
- **대량 알림 제한**: 카페 10개, 트위터 5개 초과시 나머지는 기록만 저장
- **순차 발송**: 2초 간격으로 알림 스팸 방지

### 🛡️ 스마트 제한 시스템

#### 📊 상황별 대응

| 상황 | 카페 알림 | 트위터 알림 | 처리 방식 |
|------|-----------|-------------|-----------|
| 앱 종료 후 5개 새 글 | 5개 모두 알림 | 5개 모두 알림 | 정상 처리 |
| 앱 종료 후 20개 새 글 | 10개 알림 + 10개 기록 | 5개 알림 + 15개 기록 | 제한 적용 |
| 실시간 중 연속 새 글 | 모두 알림 (1초 간격) | 모두 알림 (1초 간격) | 간격 제어 |

#### ⚠️ 알림 누락 상황
- **RSS 제한**: 트위터 RSS가 최신 20개만 제공하는 경우
- **장기간 종료**: 앱을 며칠간 꺼둔 경우 일부 항목 누락 가능
- **해결책**: 정기적인 앱 실행 권장 (하루 1회 이상)

### 🎨 알림 디자인

#### 📱 Windows 토스트 알림
```
┌─────────────────────────────┐
│ 🖼️ [프로필]  아리사 방송 시작!    │
│              신규 게임 플레이!   │
│              📌 클릭해서 시청    │
└─────────────────────────────┘
```

#### 🖼️ 프로필 이미지
- **소스**: 치지직 채널 API에서 가져옴
- **크기**: 80x80 픽셀로 자동 최적화
- **캐시**: 임시 폴더에 저장하여 재사용
- **형식**: JPEG (85% 품질)

### 🔧 알림 시스템 아키텍처

#### 📝 처리 흐름
```
모니터 → 알림 매니저 → Windows 토스트 알림 → 사용자
  ↓           ↓              ↓
저장      이미지 처리     클릭 액션
```

#### 🔄 중복 방지 시스템
1. **기존 기록 확인**: `notifications.json`에서 이미 알림된 항목 추출
2. **새 항목 필터링**: URL 기반으로 중복 제거
3. **캐시 업데이트**: 새로운 항목 ID를 캐시에 저장

#### 🚨 오류 처리 단계
```
1차: win11toast 클릭 가능 알림
 ↓ 실패시
2차: 간단 알림 + URL 클립보드 복사  
 ↓ 실패시
3차: 브라우저 직접 열기
 ↓ 실패시  
4차: 콘솔 출력
```

### 📁 캐시 파일 구조
```
data/
├── notifications.json          # 알림 기록
├── cafe_posts_cache.json      # 카페 게시물 캐시
├── twitter_tweets_cache.json  # 트윗 캐시
└── browser_data/              # 브라우저 캐시 및 세션
```

## 설정 옵션

- **체크 간격**: 모니터링 주기 설정 (기본: 30초)
- **캐시 정리 간격**: 자동 캐시 정리 주기 설정 (기본: 3600초/1시간)
- **윈도우 시작시 자동 실행**: 부팅 후 자동 시작
- **알림 표시**: 알림 활성화/비활성화
- **테마**: 다크/라이트 모드 선택

## 파일 구조

```
data/
├── streamers.json              # 스트리머 정보
├── notifications.json          # 알림 기록
├── settings.json               # 앱 설정
├── browser_session.json        # 브라우저 세션 데이터
├── live_status.json            # 실시간 라이브 상태
├── cafe_posts_cache.json       # 카페 게시물 캐시 (중복 방지용)
├── twitter_tweets_cache.json   # 트윗 캐시 (중복 방지용)
└── browser_data/               # 브라우저 캐시 및 세션 데이터

logs/
└── streamer_alarm_YYYYMMDD.log # 일별 로그 파일 (10MB 로테이션)

src/
├── config.py              # 설정 관리
├── monitors/              # 플랫폼별 모니터링 모듈
├── browser/               # 브라우저 자동화
├── ui/                    # 웹 UI 컴포넌트
└── utils/                 # 유틸리티 모듈
    ├── cache_cleaner.py   # 자동 캐시 정리
    ├── notification.py    # 윈도우 알림
    └── logger.py          # 로깅 시스템
```

## 자동 캐시 정리

애플리케이션은 성능 최적화를 위해 자동 캐시 정리 시스템을 포함합니다:

- **주기적 정리**: 1시간마다 자동으로 브라우저 캐시 정리
- **안전한 정리**: 중요한 세션 데이터는 보존하면서 캐시만 삭제
- **디스크 공간 절약**: 정리 없이 300MB+ 증가할 수 있는 캐시 크기 관리
- **설정 가능**: cache_cleanup_interval 설정으로 간격 조정 가능

## 문제 해결

### 네이버 로그인 실패
- 브라우저 데이터 초기화: `data/browser_data` 폴더 삭제
- 세션 파일 삭제: `data/browser_session.json` 삭제
- 앱 재시작 후 다시 로그인

### RSS 피드 오류
- 여러 Nitter 인스턴스를 백업으로 사용합니다
- 네트워크 연결 상태를 확인하세요

### 알림이 표시되지 않음
- 윈도우 알림 설정에서 앱 권한 확인
- 설정 탭에서 "알림 표시" 옵션 확인
- 설정 탭의 "알림 테스트" 버튼으로 테스트

### 성능 문제
- 자동 캐시 정리가 1시간마다 실행됩니다
- 로그 파일은 10MB마다 자동 로테이션됩니다
- 7일 이상 된 로그는 자동 삭제됩니다

### 웹 인터페이스 접속 불가
- 기본 포트: http://localhost:8501
- 방화벽 설정 확인
- 포트 충돌 시 다른 포트 사용

## 기능 특징

### 듀얼 브라우저 시스템
- 모니터링용 헤드리스 브라우저와 사용자 로그인용 브라우저 분리
- 안정적인 세션 관리 및 충돌 방지

### 실시간 UI 업데이트
- 라이브 상태 파일을 통한 실시간 스트리머 상태 표시
- 2초마다 UI 신호 처리로 빠른 응답성

### 최적화된 HTTP 통신
- 연결 풀링으로 효율적인 네트워크 사용
- 플랫폼별 최적화된 타임아웃 설정

## 라이선스

이 프로젝트는 개인 사용 목적으로 제작되었습니다.

## 🏗️ 시스템 아키텍처

### 📊 전체 시스템 개요

```
┌─────────────────────────────────────────────────────────────┐
│                      스트리머 알림 시스템                        │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐      │
│  │   UI Layer  │    │ 시스템 트레이  │    │ 알림 시스템   │      │
│  │ (Streamlit) │◄───┤   관리자     │◄───┤ (win11toast)│      │
│  └─────────────┘    └─────────────┘    └─────────────┘      │
│         │                   │                    ▲         │
│         ▼                   ▼                    │         │
│  ┌─────────────┐    ┌─────────────┐              │         │
│  │ IPC 통신    │    │ 오케스트레이터 │              │         │
│  │ (JSON 파일) │◄───┤  (main.py)  │──────────────┘         │
│  └─────────────┘    └─────────────┘                        │
│         ▲                   │                              │
│         │                   ▼                              │
│  ┌─────────────┐    ┌─────────────┐                        │
│  │ 데이터 저장  │    │ 모니터링     │                        │
│  │ (JSON)     │◄───┤ 엔진        │                        │
│  └─────────────┘    └─────────────┘                        │
│                            │                              │
│         ┌──────────────────┼──────────────────┐             │
│         ▼                  ▼                  ▼             │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐      │
│  │  치지직      │    │  네이버      │    │   트위터     │      │
│  │ 모니터링     │    │ 카페        │    │  모니터링    │      │
│  └─────────────┘    └─────────────┘    └─────────────┘      │
│         │                  │                  │             │
│         ▼                  ▼                  ▼             │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐      │
│  │ CHZZK API   │    │ Playwright   │    │ RSS 피드     │      │
│  │ (HTTP)      │    │ 브라우저     │    │ (Nitter)    │      │
│  └─────────────┘    └─────────────┘    └─────────────┘      │
└─────────────────────────────────────────────────────────────┘
```

### 🔄 핵심 컴포넌트 아키텍처

#### 1️⃣ **메인 오케스트레이터 (main.py)**
```
┌─────────────────────────────────────────────────────────────┐
│                    StreamerAlarmApp                         │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐      │
│  │ Streamlit   │    │ 시스템 트레이 │    │ 신호 핸들러  │      │
│  │ 서버 관리    │    │ 아이콘      │    │ (SIGINT)    │      │
│  └─────────────┘    └─────────────┘    └─────────────┘      │
│         │                   │                    │         │
│         ▼                   ▼                    ▼         │
│  ┌─────────────────────────────────────────────────────────┐│
│  │              AsyncIO 이벤트 루프                          ││
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐  ││
│  │  │ 모니터링     │    │ UI 신호     │    │ 캐시 정리    │  ││
│  │  │ 태스크      │    │ 처리        │    │ 태스크      │  ││
│  │  │ (30초 간격) │    │ (2초 간격)  │    │ (1시간 간격) │  ││
│  │  └─────────────┘    └─────────────┘    └─────────────┘  ││
│  └─────────────────────────────────────────────────────────┘│
└─────────────────────────────────────────────────────────────┘
```

#### 2️⃣ **모니터링 시스템 아키텍처**
```
┌─────────────────────────────────────────────────────────────┐
│                    모니터링 엔진                              │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐      │
│  │ CHZZK       │    │ 카페        │    │ 트위터      │      │
│  │ Monitor     │    │ Monitor     │    │ Monitor     │      │
│  └─────────────┘    └─────────────┘    └─────────────┘      │
│         │                   │                    │         │
│         ▼                   ▼                    ▼         │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐      │
│  │ HTTP Client │    │ Playwright   │    │ RSS Parser  │      │
│  │ (HTTPX)     │    │ Browser     │    │ (feedparser)│      │
│  └─────────────┘    └─────────────┘    └─────────────┘      │
│         │                   │                    │         │
│         ▼                   ▼                    ▼         │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐      │
│  │ 상태 변화    │    │ 새 게시물    │    │ 새 트윗     │      │
│  │ 감지        │    │ 감지        │    │ 감지        │      │
│  └─────────────┘    └─────────────┘    └─────────────┘      │
│         │                   │                    │         │
│         └─────────┬─────────┴────────────────────┘         │
│                   ▼                                        │
│         ┌─────────────────────────────────┐                │
│         │       알림 매니저               │                │
│         │   (NotificationManager)        │                │
│         └─────────────────────────────────┘                │
└─────────────────────────────────────────────────────────────┘
```

### 🌐 네트워크 통신 아키텍처

#### 📡 **HTTP 클라이언트 시스템**
```
┌─────────────────────────────────────────────────────────────┐
│                   HTTP 통신 레이어                           │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐      │
│  │ CHZZK API   │    │ 이미지 다운로드│    │ RSS 피드    │      │
│  │ Client      │    │ Client      │    │ Client      │      │
│  │ (10초 타임아웃)│    │ (15초 타임아웃)│    │ (15초 타임아웃)│      │
│  └─────────────┘    └─────────────┘    └─────────────┘      │
│         │                   │                    │         │
│         └─────────┬─────────┴────────────────────┘         │
│                   ▼                                        │
│         ┌─────────────────────────────────┐                │
│         │      HTTPX 연결 풀              │                │
│         │ • max_connections: 10          │                │
│         │ • max_keepalive_connections: 5 │                │
│         │ • HTTP/2 지원                  │                │
│         │ • 자동 재시도                   │                │
│         └─────────────────────────────────┘                │
│                   │                                        │
│                   ▼                                        │
│         ┌─────────────────────────────────┐                │
│         │        네트워크 계층             │                │
│         │ • User-Agent 헤더 관리          │                │
│         │ • 압축 지원 (gzip, deflate)    │                │
│         │ • 리다이렉트 자동 처리           │                │
│         └─────────────────────────────────┘                │
└─────────────────────────────────────────────────────────────┘
```

### 🎭 브라우저 자동화 아키텍처

#### 🌐 **듀얼 브라우저 시스템**
```
┌─────────────────────────────────────────────────────────────┐
│                 브라우저 관리 시스템                         │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────────┐    ┌─────────────────────┐          │
│  │    사용자 로그인      │    │   헤드리스 모니터링  │          │
│  │    브라우저         │    │     브라우저        │          │
│  │ ┌─────────────────┐ │    │ ┌─────────────────┐ │          │
│  │ │ • 창 표시 모드   │ │    │ │ • 헤드리스 모드  │ │          │
│  │ │ • 사용자 상호작용│ │    │ │ • 백그라운드    │ │          │
│  │ │ • 로그인 전용   │ │    │ │ • 카페 모니터링  │ │          │
│  │ │ • 5분 타임아웃  │ │    │ │ • 세션 유지     │ │          │
│  │ └─────────────────┘ │    │ └─────────────────┘ │          │
│  └─────────────────────┘    └─────────────────────┘          │
│           │                           │                     │
│           ▼                           ▼                     │
│  ┌─────────────────────────────────────────────────────────┐│
│  │              Playwright 컨텍스트                          ││
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐  ││
│  │  │ 쿠키 저장   │    │ 세션 복원   │    │ 자동 정리    │  ││
│  │  └─────────────┘    └─────────────┘    └─────────────┘  ││
│  └─────────────────────────────────────────────────────────┘│
│                           │                                 │
│                           ▼                                 │
│         ┌─────────────────────────────────┐                │
│         │     브라우저 데이터 저장소       │                │
│         │ • data/browser_data/           │                │
│         │ • 영구 컨텍스트               │                │
│         │ • 암호화된 쿠키               │                │
│         └─────────────────────────────────┘                │
└─────────────────────────────────────────────────────────────┘
```

### 💾 데이터 관리 아키텍처

#### 📁 **데이터 저장 계층**
```
┌─────────────────────────────────────────────────────────────┐
│                   데이터 저장 시스템                         │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐      │
│  │   설정      │    │   상태      │    │   캐시      │      │
│  │  데이터     │    │  데이터     │    │  데이터     │      │
│  └─────────────┘    └─────────────┘    └─────────────┘      │
│         │                   │                    │         │
│         ▼                   ▼                    ▼         │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐      │
│  │ streamers   │    │ live_status │    │ posts_cache │      │
│  │ settings    │    │ session     │    │ tweets_cache│      │
│  │ .json       │    │ .json       │    │ .json       │      │
│  └─────────────┘    └─────────────┘    └─────────────┘      │
│         │                   │                    │         │
│         └─────────┬─────────┴────────────────────┘         │
│                   ▼                                        │
│         ┌─────────────────────────────────┐                │
│         │       JSON 파일 관리자          │                │
│         │ • 안전한 쓰기 (임시파일 사용)   │                │
│         │ • 원자적 연산                  │                │
│         │ • 백업 및 복구                 │                │
│         │ • UTF-8 인코딩                │                │
│         └─────────────────────────────────┘                │
│                   │                                        │
│                   ▼                                        │
│         ┌─────────────────────────────────┐                │
│         │        파일 시스템              │                │
│         │ • data/ 디렉토리               │                │
│         │ • logs/ 디렉토리               │                │
│         │ • 자동 디렉토리 생성            │                │
│         └─────────────────────────────────┘                │
└─────────────────────────────────────────────────────────────┘
```

### 🔔 알림 시스템 세부 아키텍처

#### 📢 **알림 처리 파이프라인**
```
┌─────────────────────────────────────────────────────────────┐
│                  알림 처리 시스템                            │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐      │
│  │   이벤트    │    │   필터링    │    │   알림      │      │
│  │   감지      │    │   처리      │    │   발송      │      │
│  └─────────────┘    └─────────────┘    └─────────────┘      │
│         │                   │                    │         │
│         ▼                   ▼                    ▼         │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐      │
│  │ • 상태 변화 │    │ • 중복 제거 │    │ • 이미지    │      │
│  │ • 새 게시물 │    │ • 알림 제한 │    │   다운로드  │      │
│  │ • 새 트윗   │    │ • 간격 제어 │    │ • 토스트    │      │
│  └─────────────┘    └─────────────┘    └─────────────┘      │
│         │                   │                    │         │
│         └─────────┬─────────┴────────────────────┘         │
│                   ▼                                        │
│         ┌─────────────────────────────────┐                │
│         │      NotificationManager       │                │
│         │                               │                │
│         │  ┌─────────────────────────┐   │                │
│         │  │ 1. 프로필 이미지 처리   │   │                │
│         │  │ 2. HTML 콘텐츠 정리    │   │                │
│         │  │ 3. URL 변환/검증       │   │                │
│         │  │ 4. win11toast 호출     │   │                │
│         │  │ 5. 기록 저장           │   │                │
│         │  └─────────────────────────┘   │                │
│         └─────────────────────────────────┘                │
│                   │                                        │
│                   ▼                                        │
│         ┌─────────────────────────────────┐                │
│         │        오류 처리 체인            │                │
│         │ 1차: win11toast (클릭 가능)     │                │
│         │ 2차: 간단 toast + 클립보드      │                │
│         │ 3차: 브라우저 직접 열기         │                │
│         │ 4차: 콘솔 출력                 │                │
│         └─────────────────────────────────┘                │
└─────────────────────────────────────────────────────────────┘
```

### 🔄 IPC 통신 아키텍처

#### 📡 **프로세스 간 통신 시스템**
```
┌─────────────────────────────────────────────────────────────┐
│                   IPC 통신 시스템                            │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────────┐         ┌─────────────────────┐     │
│  │    Streamlit UI     │         │   메인 프로세스      │     │
│  │   (별도 프로세스)    │         │   (모니터링 엔진)    │     │
│  └─────────────────────┘         └─────────────────────┘     │
│           │                               │                 │
│           ▼                               ▼                 │
│  ┌─────────────────────┐         ┌─────────────────────┐     │
│  │   요청 파일 생성     │         │   신호 파일 감지     │     │
│  │ • login_request     │◄────────┤ • 2초마다 폴링      │     │
│  │ • settings_update   │         │ • 비동기 처리       │     │
│  │ • notification_test │         │                    │     │
│  └─────────────────────┘         └─────────────────────┘     │
│           │                               │                 │
│           ▼                               ▼                 │
│  ┌─────────────────────────────────────────────────────────┐│
│  │              JSON 파일 기반 통신                          ││
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐  ││
│  │  │ 요청/응답   │    │ 상태 공유   │    │ 결과 전달   │  ││
│  │  │ 패턴       │    │ 패턴       │    │ 패턴       │  ││
│  │  └─────────────┘    └─────────────┘    └─────────────┘  ││
│  └─────────────────────────────────────────────────────────┘│
│                           │                                 │
│                           ▼                                 │
│         ┌─────────────────────────────────┐                │
│         │       파일 동기화 관리          │                │
│         │ • 안전한 읽기/쓰기             │                │
│         │ • 락 메커니즘                 │                │
│         │ • 타임아웃 처리               │                │
│         └─────────────────────────────────┘                │
└─────────────────────────────────────────────────────────────┘
```

### 🧹 캐시 관리 아키텍처

#### 🗂️ **자동 캐시 정리 시스템**
```
┌─────────────────────────────────────────────────────────────┐
│                 캐시 관리 시스템                             │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐      │
│  │   감시      │    │   정리      │    │   보존      │      │
│  │  시스템     │    │  엔진       │    │  시스템     │      │
│  └─────────────┘    └─────────────┘    └─────────────┘      │
│         │                   │                    │         │
│         ▼                   ▼                    ▼         │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐      │
│  │ • 1시간 간격│    │ • 브라우저   │    │ • 세션 데이터│      │
│  │ • 크기 모니터│    │   캐시 삭제 │    │ • 쿠키 보존 │      │
│  │ • 로그 추적 │    │ • 임시파일  │    │ • 설정 유지 │      │
│  └─────────────┘    └─────────────┘    └─────────────┘      │
│         │                   │                    │         │
│         └─────────┬─────────┴────────────────────┘         │
│                   ▼                                        │
│         ┌─────────────────────────────────┐                │
│         │      CacheCleaner              │                │
│         │                               │                │
│         │  ┌─────────────────────────┐   │                │
│         │  │ • cleanup_browser_cache │   │                │
│         │  │ • cleanup_temp_files    │   │                │
│         │  │ • cleanup_old_logs      │   │                │
│         │  │ • preserve_sessions     │   │                │
│         │  └─────────────────────────┘   │                │
│         └─────────────────────────────────┘                │
│                   │                                        │
│                   ▼                                        │
│         ┌─────────────────────────────────┐                │
│         │        정리 결과 보고           │                │
│         │ • 해제된 용량 (MB)             │                │
│         │ • 삭제된 파일 수               │                │
│         │ • 오류 발생 여부               │                │
│         │ • 로그 기록                   │                │
│         └─────────────────────────────────┘                │
└─────────────────────────────────────────────────────────────┘
```

### 🎯 성능 최적화 아키텍처

#### ⚡ **성능 최적화 전략**
```
┌─────────────────────────────────────────────────────────────┐
│                 성능 최적화 시스템                           │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐      │
│  │   네트워크  │    │   메모리    │    │   디스크    │      │
│  │   최적화    │    │   최적화    │    │   최적화    │      │
│  └─────────────┘    └─────────────┘    └─────────────┘      │
│         │                   │                    │         │
│         ▼                   ▼                    ▼         │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐      │
│  │ • HTTP 풀링│    │ • 이미지     │    │ • 로그      │      │
│  │ • 재사용    │    │   리사이즈  │    │   로테이션  │      │
│  │ • 압축 지원 │    │ • 캐시 관리 │    │ • 자동 정리 │      │
│  └─────────────┘    └─────────────┘    └─────────────┘      │
│         │                   │                    │         │
│         └─────────┬─────────┴────────────────────┘         │
│                   ▼                                        │
│         ┌─────────────────────────────────┐                │
│         │        성능 모니터링            │                │
│         │                               │                │
│         │  ┌─────────────────────────┐   │                │
│         │  │ • 응답 시간 추적        │   │                │
│         │  │ • 메모리 사용량 감시    │   │                │
│         │  │ • 디스크 용량 확인      │   │                │
│         │  │ • 오류 발생 빈도        │   │                │
│         │  └─────────────────────────┘   │                │
│         └─────────────────────────────────┘                │
│                   │                                        │
│                   ▼                                        │
│         ┌─────────────────────────────────┐                │
│         │        자동 조정 시스템          │                │
│         │ • 체크 간격 동적 조정           │                │
│         │ • 오류 시 백오프 전략           │                │
│         │ • 리소스 부족 시 정리 실행      │                │
│         └─────────────────────────────────┘                │
└─────────────────────────────────────────────────────────────┘
```

### 🔐 보안 및 안정성 아키텍처

#### 🛡️ **보안 계층**
```
┌─────────────────────────────────────────────────────────────┐
│                   보안 및 안정성                            │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐      │
│  │   인증      │    │   데이터    │    │   오류      │      │
│  │   보안      │    │   보호      │    │   복구      │      │
│  └─────────────┘    └─────────────┘    └─────────────┘      │
│         │                   │                    │         │
│         ▼                   ▼                    ▼         │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐      │
│  │ • 브라우저  │    │ • JSON 검증 │    │ • 예외 처리 │      │
│  │   세션 암호화│    │ • 파일 권한 │    │ • 자동 재시도│      │
│  │ • 쿠키 보호 │    │ • 백업 생성 │    │ • 상태 복구 │      │
│  └─────────────┘    └─────────────┘    └─────────────┘      │
│         │                   │                    │         │
│         └─────────┬─────────┴────────────────────┘         │
│                   ▼                                        │
│         ┌─────────────────────────────────┐                │
│         │       보안 정책 관리            │                │
│         │                               │                │
│         │  ┌─────────────────────────┐   │                │
│         │  │ • 민감 정보 로깅 방지   │   │                │
│         │  │ • API 키 환경변수 관리  │   │                │
│         │  │ • 파일 시스템 권한      │   │                │
│         │  │ • 네트워크 보안 헤더    │   │                │
│         │  └─────────────────────────┘   │                │
│         └─────────────────────────────────┘                │
│                   │                                        │
│                   ▼                                        │
│         ┌─────────────────────────────────┐                │
│         │        안정성 보장              │                │
│         │ • 신호 처리 (SIGINT/SIGTERM)   │                │
│         │ • 리소스 정리 (브라우저/HTTP)  │                │
│         │ • 상태 일관성 유지             │                │
│         │ • 크래시 복구                 │                │
│         └─────────────────────────────────┘                │
└─────────────────────────────────────────────────────────────┘
```

이 시스템 아키텍처는 **확장성**, **안정성**, **성능**을 모두 고려한 모듈형 설계를 제공합니다. 각 컴포넌트는 독립적으로 동작하면서도 효율적으로 통신하여 안정적인 스트리머 모니터링 서비스를 제공합니다.